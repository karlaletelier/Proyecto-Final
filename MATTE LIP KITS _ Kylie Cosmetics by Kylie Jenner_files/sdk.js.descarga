var Widgetic=function(){"use strict";var o,i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(t,e){return t(e={exports:{}},e.exports),e.exports}(o=function(t){var e,i,n,r;for(i=(n=o.options).parser[n.strictMode?"strict":"loose"].exec(t),r={},e=14;e--;)r[n.key[e]]=i[e]||"";return r[n.q.name]={},r[n.key[12]].replace(n.q.parser,function(t,e,i){if(e)return r[n.q.name][e]=i}),r[n.h.name]={},r[n.key[13]].replace(n.h.parser,function(t,e,i){if(e)return r[n.h.name][e]=i}),r}).options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","hash"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},h:{name:"hashKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var e,n,r,s,a,u,c,l,h,d,p,f,m=o;(f=window.location).origin||(f.origin=f.protocol+"//"+f.hostname+(f.port?":"+f.port:"")),a=m,e=(null!=(l=window.widgeticOptions)?l.domain:void 0)||"widgetic.com",n=(null!=(h=window.widgeticOptions)?h.domainProtocol:void 0)||"https",s="?lo="+encodeURIComponent(f.origin);var g,y,v={proxy:(c=!1===(null!=(d=window.widgeticOptions)?d.secure:void 0)?"http":"https")+"://"+(r=(u=a(e)).host+(u.port?":"+u.port:""))+"/sdk/proxy.html"+s+"#proxy",popup:c+"://"+r+"/sdk/proxy.html"+s+"#popup",auth:c+"://"+e+"/oauth/v2/auth",composition:c+"://"+e+"/api/v2/compositions/{id}/embed.html"+s,widget:c+"://"+e+"/api/v2/widgets/{id}/embed.html"+s,editor:c+"://"+e+"/api/v2/editor.html"+s,plugin:c+"://"+r+"/plugin"+s,api:"/api/v2/",domain:n+"://"+r,lo:decodeURIComponent(a(f).queryKey.lo||f.origin),crossdomain:(null!=(p=window.widgeticOptions)?p.crossdomain:void 0)||!0};g="addEventListener",y="removeEventListener";var _,w,b={on:function(t,e,i,n){return null==n&&(n=!1),t[g]?t[g](e,i,n):t.attachEvent("on"+e,i)},off:function(t,e,i,n){return null==n&&(n=!1),t[y]?t[y](e,i,n):t.detachEvent("on"+e,i)}},k=t(function(t,e){t.exports=function(t,e,i){e=e||"";var n=(i=i||{}).complete||function(){},r=i.success||function(){},o=i.error||function(){},s=i.headers||{},a=i.method||"GET",u=i.sync||!1,c=0===t.indexOf("http")&&"undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest;if(!c)throw new Error("Browser doesn't support XHR");if("string"!=typeof e){var l=[];for(var h in e)l.push(h+"="+e[h]);e=l.join("&")}for(var d in"ontimeout"in c&&(c.ontimeout=+i.timeout||0),c.onload=function(){n(c.responseText,c.status),r(c.responseText)},c.onerror=function(){n(c.responseText),o(c.responseText,c.status)},c.open(a,"GET"===a&&e?t+"?"+e:t,!u),s)c.setRequestHeader(d,s[d]);return c.send("GET"!==a?e:null),c}});w=k,_=v;function S(t){var e,i,n,r,o,s;if(t.id&&(e=t.a))return s=e.u,o=e.m,i=e.d,r={id:t.id,t:"e",a:{}},n={"Content-type":"application/json"},"PUT"!==(o=o.toUpperCase())&&"DELETE"!==o||(n["X-HTTP-Method-Override"]=o,o="POST"),w(s,i,{method:o,headers:n,complete:function(t,e){return r.a.t=200===e||201===e||202===e||204===e?"t":"f",r.a.d=t,r=JSON.stringify(r),_.crossdomain?window.parent.postMessage(r,"*"):window.widgeticReceiver({origin:window.location.origin,data:r})}})}var x=[].slice,E={};function C(t){this._size=t,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function T(e){if(!e._start)try{!function(t){for(;t._start=t._waiting&&t._active<t._size;){var e=t._ended+t._active,i=t._tasks[e],n=i.length-1,r=i[n];i[n]=A(t,e),--t._waiting,++t._active,i=r.apply(null,i),t._tasks[e]&&(t._tasks[e]=i||E)}}(e)}catch(t){if(e._tasks[e._ended+e._active-1])O(e,t);else if(!e._data)throw t}}function A(i,n){return function(t,e){i._tasks[n]&&(--i._active,++i._ended,(i._tasks[n]=null)==i._error&&(null!=t?O(i,t):(i._data[n]=e,i._waiting?T(i):M(i))))}}function O(t,e){var i,n=t._tasks.length;for(t._error=e,t._data=void 0,t._waiting=NaN;0<=--n;)if((i=t._tasks[n])&&(t._tasks[n]=null,i.abort))try{i.abort()}catch(e){}t._active=NaN,M(t)}function M(t){if(!t._active&&t._call){var e=t._data;t._data=void 0,t._call(t._error,e)}}function q(t){if(null==t)t=1/0;else if(!(1<=(t=+t)))throw new Error("invalid concurrency");return new C(t)}C.prototype=q.prototype={constructor:C,defer:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("defer after await");if(null!=this._error)return this;var e=x.call(arguments,1);return e.push(t),++this._waiting,this._tasks.push(e),T(this),this},abort:function(){return null==this._error&&O(this,new Error("abort")),this},await:function(i){if("function"!=typeof i)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=function(t,e){i.apply(null,[t].concat(e))},M(this),this},awaitAll:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=t,M(this),this}};var z,I,R,j=Object.freeze({queue:q});I=j.queue(1),R={},z=function(t){return R.init=t},I.defer(z),I.steps=R;function N(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return t()+t(!0)+t(!0)+t()}var P,H,L,U,D=I,W=Object.freeze({default:N}),J=t(function(t,e){var i;i=function(){function u(){var e=!1;return function(t){return function(){e||(e=!0,t.apply(null,arguments))}}}function c(i,n){function r(e,i){setTimeout(function(){var t;try{t=e(i)}catch(t){return void o.reject(t)}t===o.promise?o.reject(new TypeError("Cannot resolve promise with itself")):o.resolve(t)},1)}var o=t.defer();return{promise:o.promise,handle:function(t,e){t===l?function(t){i&&i.call?r(i,t):o.resolve(t)}(e):function(t){n&&n.call?r(n,t):o.reject(t)}(e)}}}var t={},l=1;return t.defer=function(){function i(t,e){o=t,r=e,s.forEach(function(t){t.handle(o,r)}),s=null}function n(t){i(2,t)}function e(t,e){var i=c(t,e);return 0===o?s.push(i):i.handle(o,r),i.promise}var r,o=0,s=[],a=function(t){var e;try{e=function(t){var e=t&&t.then;if("object"==typeof t&&"function"==typeof e)return function(){return e.apply(t,arguments)}}(t)}catch(t){return void n(t)}e?function(t){var e=u();try{t(e(a),e(n))}catch(t){e(n)(t)}}(e):function(t){i(l,t)}(t)},t=u();return{resolve:t(a),reject:t(n),promise:{then:e,fail:function(t){return e(null,t)}}}},t},t.exports=i()}),B=t(function(t){function e(){var o={},s=Function;return{publish:function(){var t,e,i,n=arguments,r=o[n[0]];r&&(t=r.length,e=1<n.length?Array.prototype.splice.call(n,1):[],setTimeout(function(){for(i=0;i<t;i+=1)r[i].apply(a,e);r=a=e=null},0))},subscribe:function(t,e){if("string"!=typeof t)throw"invalid or missing channel";if(!(e instanceof s))throw"invalid or missing callback";return o[t]||(o[t]=[]),o[t].push(e),{channel:t,callback:e}},unsubscribe:function(t,e){if(t.channel&&t.callback&&(e=t.callback,t=t.channel),"string"!=typeof t)throw"invalid or missing channel";if(!(e instanceof s))throw"invalid or missing callback";var i,n=o[t],r=n instanceof Array?n.length:0;for(i=0;i<r;i+=1)if(n[i]===e){n.splice(i,1);break}}}}var a;a=i,t.exports?t.exports=e():a.PubSub=e()}),Q=W&&N||W;P=Q,U=window,H={},L=function(t,e){return"location=no,menubar=no,toolbar=no,scrollbars=no,status=no,resizable=no,width="+t+",height="+e+",left="+(screen.width-t)/2+",top="+(screen.height-e)/2};function K(t,e){var i,n,r,o;return n=e.promise,null!=(r=H.win)&&r.close(),H.win=o=U.open(t,"widgetic_popup_"+P(),L(500,496)),i=setInterval(function(){if(!o||o.closed)return clearInterval(i),e.reject("window closed")},50),n.then(function(){return o.close()}),n}var V,G;G={},(V=function(t,e){var i,n,r,o;return r=e.promise,V=document.createElement("iframe"),(n=G.root.el).appendChild(V),i=function(){return n.removeChild(V),clearTimeout(o)},o=setTimeout(function(){return e.reject("Timeout error")},1e4),r.then(i,i),V.setAttribute("src",t),r}).setRoot=function(t){return G.root=t};var $,X,Y,F,Z,tt,et,it,nt,rt,ot,st,at=V;tt=v,X=At,ot=K,it=at,Z=J,Y={},rt={},nt=[],st=function(t,e){return null==t&&(t=[]),null==e&&(e="oauth"),tt.auth+"?client_id="+Y.id+"&redirect_uri="+Y.uri+"&response_type=token&scope="+t.join(" ")+"#"+e},$=function(t,e){var i;return null==t&&(t=!0),i=Z.defer(),e&&(nt=e),{oa:t?ot:it,scope:e=nt,deffered:rt.deffered=i}},et=function(t,e,i){return Y.id&&Y.uri?t(e,i):(i.reject("Widgetic must be initialized with client id and redirect uri!"),i.promise)},(F=function(){var t,e,i,n;return e=(i=$.apply(null,arguments)).oa,n=i.scope,t=i.deffered,et(e,st(n),t)}).register=function(t){var e,i,n;return i=(n=$(!0,t)).oa,t=n.scope,e=n.deffered,et(i,st(t,"signup"),e)},F.setAuthOptions=function(t,e,i){return Y.id=t,Y.uri=e},F.getClientId=function(){return Y.id},F.retry=function(t){return F.apply(this,t.d)};var ut,ct,lt,ht,dt,pt,ft,mt,gt,yt,vt,_t,wt,bt=F;lt=v,yt=S,gt=D,dt=Q,ct=J,mt=B,ht={},pt={},_t=wt=null,ft=function(t,e,i,n){var r,o;return t=lt.api+t,r=(null!=(o=pt.tokens)?o.access_token:void 0)||!1,(e=e||"GET")instanceof Object&&(i=e,e="GET"),"GET"!==e?t+=r?"?access_token="+r:"":(i=i||{},r&&(i.access_token=r)),JSON.stringify({t:"a",id:n,a:{u:t,m:e,d:i}})},(ut=function(t,e,i){var n,r,o,s,a;return o=dt(),a=(ht[o]=r=ct.defer()).promise,s=ft.apply(this,r.margs=[t,e,i,o]),n=function(){return ht[o]=null},a.then(n,n),pt.proxy(s),a}).response=function(t){var e,i,n,r,o,s;if(n=ht[t.id],""!==(i=(e=t.a).d))try{i=JSON.parse(i)}catch(t){return void n.reject(new Error("JSON Parse error!"))}return"t"===e.t?n.resolve(i):pt.tokens&&i.error&&("invalid_grant"===(s=i.error)||"access_denied"===s)?(o=function(){return wt=null,pt.proxy(ft.apply(this,n.margs))},vt().then(o,function(){return wt=null,n.reject(new Error("Unable to login again!"))})):((r=new Error(i.error_description||i.message||"Unknown Error")).errors=i.errors,r.code=i.code,n.reject(r))},vt=function(){var t,e,i;return null!=(t=bt).getClientId()?t(!1):(i=(wt=ct.defer()).promise,e=JSON.stringify({t:"r",d:[!1]}),window.parent.postMessage(e,lt.lo),_t=setTimeout(wt.reject,3e3),i)},ut.setProxy=function(t){return pt.proxy=t},ut.setTokens=function(t){return pt.tokens=t,mt.publish("api/token/update")},ut.getStatus=function(){var t;return(null!=(t=pt.tokens)?t.access_token:void 0)?{status:"connected",accessToken:pt.tokens.access_token,refreshToken:pt.tokens.refresh_token,expiresIn:pt.tokens.expires_in,scope:pt.tokens.scope}:{status:"disconnected"}},ut.accessToken=function(t){var e;return t&&(clearTimeout(_t),null!=wt&&wt.resolve(t),ut.setTokens({access_token:t,refresh_token:void 0,expires_in:void 0,scope:void 0})),null!=(e=pt.tokens)?e.access_token:void 0},ut.disconnect=function(){return mt.publish("api/token/update"),pt.tokens=null},ut.queue=gt,ut.request=yt;var kt,St,xt,Et,Ct,Tt,At=ut;F.connect=function(t){var e;return(e=t.d)&&e.access_token?(ut.setTokens(e),rt.deffered.resolve(ut.getStatus()),setTimeout(F.bind(this,!1),1e3*e.expires_in-1500)):rt.deffered.reject(X.getStatus())},xt=v,Et=at,Tt=(St=At).queue.steps,kt=function(){return document.getElementsByTagName("body")[0].appendChild(this.el=document.createElement("div")),this.el.id="widgetic-root",Et.setRoot(this),this},Ct=J.defer(),kt.prototype.createProxy=function(){var e,t;return Tt.init&&(xt.crossdomain?(e=document.createElement("iframe"),this.el.appendChild(e),t=setTimeout(function(){return kt._done=null,clearTimeout(t),Ct.reject(new Error("Could not initialize cross-domain messaging iframe"))},1e4),kt._done=function(){return St.setProxy(function(t){return e.contentWindow.postMessage(t,xt.domain)}),clearTimeout(t),Tt.init(),kt._done=Tt.init=null,Ct.resolve()},e.setAttribute("src",xt.proxy)):(St.setProxy(function(t){return window.widgeticReceiver({origin:window.location.origin,data:t})}),Tt.init(),kt._done=Tt.init=null,Ct.resolve())),Ct.promise},kt.connect=function(){return"function"==typeof kt._done?kt._done():void 0},kt.style=function(){var t;return document.getElementsByTagName("head")[0].appendChild(t=document.createElement("style")),t.textContent="#widgetic-root{position:absolute;top:-1000px;left:-1000px;width:0px;height:0px;visibility:hidden;z-index:-1} #widgetic-root iframe{width:0px;height:0px} iframe.widgetic-composition {border: none;width: 100%;height: 100%;vertical-align: middle;} iframe.widgetic-editor {width: 490px; height: 565px; border:none;overflow:hidden} .wdgtc-wrap{overflow: hidden}"};var Ot,Mt,qt,zt,It=kt;Ot=v,qt=m,zt=window,(Mt=function(t){var e,i,n,r,o,s,a,u,c,l;if((!zt.parent||zt.parent!==zt||zt.opener)&&(i=(a=qt(t)).hash,n=a.hashKey,u=a.queryKey,s="proxy"===i,o=n.hasOwnProperty("popup"),(r=n.hasOwnProperty("oauth")||n.access_token)||s||o))return r&&(l="o"),s&&(l="i"),o&&(l="p"),e=i?n:u,c=r?zt.location.origin:Ot.lo,(zt.opener||zt.parent).postMessage(JSON.stringify({d:e,t:l}),c)}).parse=qt;function Rt(t){var e;if("interactive"!==(e=document.readyState)&&"complete"!==e)return document.addEventListener("DOMContentLoaded",t);t()}var jt,Nt,Pt,Ht,Lt,Ut,Dt,Wt,Jt,Bt,Qt,Kt,Vt=Mt,Gt=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},$t=[].slice;for(Wt in Lt=v,Dt=Q,Qt=j.queue,Nt=At,Pt=bt,Ht={},Bt={},Kt=["click","dblclick","mousedown","mousemove","mouseup","mouseenter","mouseleave","mouseover","mouseout","wheel","keydown","keyup","keypress"],(jt=function(t,e,i){var n,r,o,s,a,u,c,l,h,d,p,f,m;if(null==i&&(i={}),"string"==typeof e&&(r=e),c=r?i:e,null==r&&(r=c.composition),this._initQueue(),this._callbacks={},p=r?Lt.composition.replace("{id}",r):Lt.widget.replace("{id}",c.widget_id),c.skin&&(this.changeSkin(c.skin),c.skin.id&&(p+="&theme="+c.skin.id)),c.content)for(s=0,a=(h=c.content).length;s<a;s++)o=h[s],this.addContent(o);return p+="&demo="+c.demo,l=[],n=Pt.getClientId(),"connected"===Nt.getStatus().status,(d=c.token||Nt.accessToken())&&l.push("access_token="+d),n&&l.push("client_id="+n),c.wait_editor_init&&l.push("wait"),c.branding&&l.push("branding"),c.brand_pos&&l.push("bp="+c.brand_pos),c.edit_mode&&l.push("edit_mode"),c.resize&&l.push("resize="+c.resize),c.autoscale&&l.push("autoscale="+c.autoscale),c.adaptive&&l.push("adaptive="+c.adaptive),l.length&&(p=p.replace(/(\?)|((.)(\#)|($))/,"?"+(l.length?l.join("&"):void 0)+"&$2")),this.id=Dt(),(Ht[this.id]=this)._iframe=document.createElement("iframe"),this._iframe.setAttribute("class","widgetic-composition"),this._iframe.setAttribute("name",this.id),this._iframe.setAttribute("allowfullscreen",!0),this._iframe.setAttribute("scrolling","no"),t.appendChild(this._iframe),u=0,this._iframe.addEventListener("load",(f=this,function(){if(1!=++u)return f._initQueue(),f._trigger("reload")})),this._iframe.setAttribute("src",p),0===this._iframe.parentElement.parentElement.className.indexOf("wdgtc-wrap")&&(this._responsiveWrapper=this._iframe.parentElement.parentElement),this._autoscale="off"!==c.autoscale,this.api=new Proxy({},{get:(m=this,function(t,r){return function(){var i,n;return i=Array.from(arguments),n=Dt(),new Promise(function(t,e){return Bt[n]={resolve:t,reject:e},m.ready.then(function(){return m._sendMessage({t:"pa",d:{id:n,method:r,args:i}})})})}})}),this}).prototype._initQueue=function(){var e;return this._queue=Qt(1),this._queue.defer((e=this,function(t){return e._startQueue=t})),this._readyDeferred=Widgetic.Aye.defer(),this.ready=this._readyDeferred.promise},jt.prototype.updateSize=function(t,e){if(this._autoscale)return e&&(e=parseInt(e,10),this._responsiveWrapper&&(this._responsiveWrapper.style.height=e+"px",this._responsiveWrapper.querySelector(".wdgtc-holder").style["padding-top"]=0),this._iframe.style.height=e+"px"),t?this._iframe.setAttribute("width",t):void 0},jt.prototype.close=function(){return Ht[this.id]=null,this._iframe.parentNode.removeChild(this._iframe),this.off(),this},jt.prototype.queue=function(e){return this._queue.defer(function(t){return e(),t()})},jt.prototype._apiReady=function(){return this._startQueue()},jt.prototype._ready=function(){return this._readyDeferred.resolve()},jt.prototype._sendMessage=function(e){var i;return this._queue.defer((i=this,function(t){return i._iframe.contentWindow.postMessage(JSON.stringify(e),"*"),t()})),this},jt.prototype.on=function(t,e){var i,n,r,o,s;for(0<=Gt.call(Kt,t)&&this._sendMessage({t:"re",d:t}),n=t.split(" "),i=this.hasOwnProperty("_callbacks")&&this._callbacks,r=0,o=n.length;r<o;r++)i[s=n[r]]||(i[s]=[]),i[s].push(e);return this},jt.prototype.off=function(t,e){var i,n,r,o,s,a,u,c,l;if(0===arguments.length)return this._callbacks={},this;if(!t)return this;for(r=0,s=(i=t.split(" ")).length;r<s;r++)if(c=i[r],u=null!=(l=this._callbacks)?l[c]:void 0)if(e){for(n=o=0,a=u.length;o<a;n=++o)if(u[n]===e){(u=u.slice()).splice(n,1),this._callbacks[c]=u;break}}else delete this._callbacks[c];return this},jt.prototype._trigger=function(){var s,a;return s=1<=arguments.length?$t.call(arguments,0):[],setTimeout((a=this,function(){var t,e,i,n,r,o;if((t=s.shift())===jt.RELAY&&(t=s[0].type),n=a.hasOwnProperty("_callbacks")&&(null!=(r=a._callbacks)?r[t]:void 0)){for(o=[],e=0,i=n.length;e<i&&!1!==n[e].apply(a,s);e++)o.push(void 0);return o}})),!0},Ut=function(t,e){return jt.prototype[t]=function(t){return this._sendMessage({t:e,d:t})}},Jt={clearContent:"cx",setContent:"sc",addContent:"ac",changeContent:"cc",removeContent:"rc",setSkin:"ss",changeSkin:"cs",addSheet:"asht",addCss:"acss"})Ut(Wt,Jt[Wt]);jt.apiReady=function(t){var e;return null!=(e=Ht[t.d])?e._apiReady():void 0},jt.connect=function(t){var e;return null!=(e=Ht[t.d])?e._ready():void 0},jt.event=function(t){return Ht[t.id]._trigger(t.e,t.d)},jt.updateSize=function(t){return Ht[t.id].updateSize(t.d.width,t.d.height)},jt.publicApiCallReply=function(t){var e,i,n,r;return r=t.id,e=t.d,(n=t.err)?((i=new Error(n.message)).stack=n.stack,Bt[r].reject(i)):Bt[r].resolve(e),delete Bt[r]},jt.RELAY="r",jt.EMBED_MODE=1,jt.EDIT_MODE=2;var Xt,Yt,Ft,Zt,te,ee,ie,ne,re=jt,oe=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},se=[].slice;Ft=v,ie=j.queue,ee=B,te=Q,Yt=At,Zt={},ne=["click","dblclick","mousedown","mousemove","mouseup","mouseenter","mouseleave","mouseover","mouseout","wheel","keydown","keyup","keypress"],(Xt=function(t,e,i){var n,r;return this.composition=e,this._queue=ie(1),this._queue.defer((r=this,function(t){return r._startQueue=t})),this._callbacks={},ee.subscribe("api/token/update",this._updateToken.bind(this)),this._updateToken(),i&&this.setEditorOptions(i),this.composition.ready.then(this._compReady.bind(this)),Zt[this.composition.id]=this,n=Ft.editor+"#"+this.composition.id,(null!=i?i.asPopup:void 0)?(this.frame=t)?this.frame.location.href=n:this.frame=window.open(n,te(),"height="+(i.h||565)+",width="+(i.w||490)):(this._iframe=document.createElement("iframe"),this._iframe.setAttribute("class","widgetic-editor"),this._iframe.setAttribute("name",te()),t.appendChild(this._iframe),this._iframe.setAttribute("src",n),this.frame=this._iframe.contentWindow),this}).prototype.close=function(){return Zt[this.composition.id]=null,this._iframe?this._iframe.parentNode.removeChild(this._iframe):this.frame.close(),this},Xt.prototype.goTo=function(t){return this._sendMessage({t:"step",d:t}),this},Xt.prototype.setEditorOptions=function(t){return this.options=null!=t?t:this.options,this._sendMessage({t:"opts",d:this.options}),this},Xt.prototype.addContent=function(t){return this._sendMessage({t:"cont",d:t}),this},Xt.prototype.save=function(){return this.goTo("done"),this},Xt.prototype.on=function(t,e){var i,n,r,o,s;for(0<=oe.call(ne,t)&&this._sendMessage({t:"ree",d:t}),n=t.split(" "),i=this.hasOwnProperty("_callbacks")&&this._callbacks,r=0,o=n.length;r<o;r++)i[s=n[r]]||(i[s]=[]),i[s].push(e);return this},Xt.prototype.off=function(t,e){var i,n,r,o,s,a,u,c,l;if(0===arguments.length)return this._callbacks={},this;if(!t)return this;for(r=0,s=(i=t.split(" ")).length;r<s;r++)if(c=i[r],u=null!=(l=this._callbacks)?l[c]:void 0)if(e){for(n=o=0,a=u.length;o<a;n=++o)if(u[n]===e){(u=u.slice()).splice(n,1),this._callbacks[c]=u;break}}else delete this._callbacks[c];return this},Xt.prototype._trigger=function(){var t,e,i,n,r,o;if((e=(t=1<=arguments.length?se.call(arguments,0):[]).shift())===Xt.RELAY&&(e=t[0].type),r=this.hasOwnProperty("_callbacks")&&(null!=(o=this._callbacks)?o[e]:void 0)){for(i=0,n=r.length;i<n&&!1!==r[i].apply(this,t);i++);return!0}},Xt.prototype._sendMessage=function(e){return this._queue.defer((i=this,function(t){return i.frame.postMessage(JSON.stringify(e),"*"),t()}));var i},Xt.prototype._ready=function(){return this.ready=!0,this._startQueue()},Xt.prototype._compReady=function(){return this.compReady=!0,this._sendMessage({t:"ready"})},Xt.prototype._updateToken=function(){return this._sendMessage({t:"token",d:Yt.accessToken()})},Xt.prototype._onConnect=function(){var e;return this.ready&&this.compReady&&this._queue.defer((e=this,function(t){return e.setEditorOptions(),e._compReady(),t()})),this._ready()},Xt.connect=function(t){return Zt[t.id]._onConnect()},Xt.event=function(t){return Zt[t.id]._trigger(t.e,t.d)},Xt.RELAY="er";var ae,ue,ce,le,he,de=Xt,pe=[].slice;function fe(t){var e,i,n;this.id=ce(),this.name=t.name||this.id,this._queue=he(1),this._queue.defer((n=this,function(t){return n._startQueue=t})),le.subscribe("api/token/update",this._updateToken.bind(this)),this._updateToken(),t&&this.setOptions(t),i=ue.plugin,(this.frame=(null!=(e=t.holder)?e.document:void 0)||t.holder)?(this._iframe=document.createElement("iframe"),this._iframe.setAttribute("class","wdtc-plugin"),this._iframe.setAttribute("name",this.name),this.frame.appendChild(this._iframe),this._iframe.setAttribute("src",i),this.frame=this._iframe.contentWindow):this.frame=window.open(i,this.name,"height="+(t.h||760)+",width="+(t.w||1270))}ue=v,he=j.queue,le=B,ce=Q,ae=At,fe.instances={},fe.connect=function(t){var e;return(e=fe.instances[t.id])._updateToken(),e._ready(),e._sendMessage({t:"ready"})},fe.event=function(t){return fe.instances[t.id]._trigger(t.e,t.d)},fe.create=function(t){var e;return null==t&&(t={}),e=new this(t),this.instances[e.id]=e},fe.prototype.close=function(){return this.constructor.instances[this.id]=null,delete this.constructor.instances[this.id],this._iframe?this._iframe.parentNode.removeChild(this._iframe):this.frame.close(),this},fe.prototype.setOptions=function(t){return this.options=null!=t?t:this.options,this._sendMessage({t:"opts",d:this.options}),this},fe.prototype.addEditorContent=function(t){return this._sendMessage({t:"econt",d:t}),this},fe.prototype.on=function(t,e){var i,n,r,o,s;for(n=t.split(" "),i=this.hasOwnProperty("_callbacks")&&(this._callbacks||(this._callbacks={})),r=0,o=n.length;r<o;r++)i[s=n[r]]||(i[s]=[]),i[s].push(e);return this},fe.prototype.off=function(t,e){var i,n,r,o,s,a,u,c,l;if(0===arguments.length)return this._callbacks={},this;if(!t)return this;for(r=0,s=(i=t.split(" ")).length;r<s;r++)if(c=i[r],u=null!=(l=this._callbacks)?l[c]:void 0)if(e){for(n=o=0,a=u.length;o<a;n=++o)if(u[n]===e){(u=u.slice()).splice(n,1),this._callbacks[c]=u;break}}else delete this._callbacks[c];return this},fe.prototype._trigger=function(){var t,e,i,n,r,o;if(e=(t=1<=arguments.length?pe.call(arguments,0):[]).shift(),r=this.hasOwnProperty("_callbacks")&&(null!=(o=this._callbacks)?o[e]:void 0)){for(i=0,n=r.length;i<n&&!1!==r[i].apply(this,t);i++);return!0}},fe.prototype._sendMessage=function(e){return this._queue.defer((i=this,function(t){return i.frame.postMessage(JSON.stringify(e),"*"),t()}));var i},fe.prototype._ready=function(){return this._startQueue()},fe.prototype._updateToken=function(){return this._sendMessage({t:"token",d:ae.accessToken()})};function me(t,e){return function(){return t.apply(e,arguments)}}var ge,ye,ve,_e,we,be,ke,Se,xe,Ee,Ce,Te,Ae,Oe,Me,qe,ze,Ie,Re,je=fe;function Ne(t){var e,i,n;for(e in this._prepare=me(this._prepare,this),this._saveInfo=me(this._saveInfo,this),this.position=me(this.position,this),this._hide=me(this._hide,this),this.resize=me(this.resize,this),this.options=t,i=this.options)n=i[e],this[e]=n;null==this.anchor&&(this.anchor=document.body),this.anchor.jquery&&(this.anchor=this.anchor[0]),this.dimensions={width:0,height:0},this.info={},this.visible=!1,this._callbacks={}}_e=J,Ae=Q,xe=b,be=v,Ee=function(t){var e,i,n,r,o=arguments;for(null==t&&(t={}),i=0,r=arguments.length;i<r;i++)if(e=o[i])for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},ke=function(t,e){var i;return null==e&&(e=10),i=null,function(){return clearTimeout(i),i=setTimeout(t,e)}},Ce=function(t){var e;return{top:(e=t.getBoundingClientRect()).top+window.scrollY,left:e.left+window.scrollX}},Oe=function(t,e,i){var n;return(n=this.document.createElement("link")).setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("charset","utf-8"),n.setAttribute("href",t),i&&(xe.on(n,"load",i),xe.on(n,"error",i)),e.appendChild(n)},Me=function(t,e,i,n){var r,o,s,a,u,c,l,h;for(null==e&&(e=[]),null==i&&(i=[]),r=[].concat(e,i),l=r.length,h=!(a=0),u=function(t){if("load"===t.type||-1<i.indexOf(t.target.href)?++a:console.log(new Error('Popup stylesheet "'+t.target.href+'" did not load!')),a===l||!h)return n()},o=0,s=r.length;o<s;o++)c=r[o],Oe.call(this,c,t,u);return setTimeout(n,5e3),setTimeout(function(){return h=!1},5e3)},Se={},qe=function(t){var e;return e=Ae(),{promise:(Se[e]=_e.defer()).promise,message:{id:e,t:"p",d:t}}},ve=function(t,e){return Se[t.id].resolve(e)},Ie=function(t,e){return null==e&&(e=window.parent),"string"==typeof e&&(e=window.frames[e]),e.postMessage(JSON.stringify(t),"*")},ze=function(t,e,i){return t.d.original=t.d.event,t.d.event="done",t.d.response=i,Ie(t,e.source)},Re=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},Te=function(e){try{return e.innerHTML}catch(t){return e.styleSheet.cssText}},we=function(t){return t?{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}:{}},ye=function(t){var e;return{popup:we(t.getBoundingClientRect()),widget:we(null!=(e=t._parentFrame)?e.getBoundingClientRect():void 0)}},Ne.styles={popup:"body { display:inline-block; margin:0; width:auto !important; height:auto !important; overflow:hidden; background:transparent !important } #loader { width: 250px; height: 250px; border: 1px solid #d5d5d5; background: white; } .sk-three-bounce { margin: 115px auto; width: 40px; text-align: center; } .sk-three-bounce .sk-child { width: 10px; height: 10px; background-color: #262424; border-radius: 100%; display: inline-block; -webkit-animation: sk-three-bounce 1.4s ease-in-out 0s infinite both; animation: sk-three-bounce 1.4s ease-in-out 0s infinite both; } .sk-three-bounce .sk-bounce1 { -webkit-animation-delay: -0.32s; animation-delay: -0.32s; } .sk-three-bounce .sk-bounce2 { -webkit-animation-delay: -0.16s; animation-delay: -0.16s; } @-webkit-keyframes sk-three-bounce { 0%, 80%, 100% { -webkit-transform: scale(0); transform: scale(0); } 40% { -webkit-transform: scale(1); transform: scale(1); } } @keyframes sk-three-bounce { 0%, 80%, 100% { -webkit-transform: scale(0); transform: scale(0); } 40% { -webkit-transform: scale(1); transform: scale(1); } }",overlay:"html, body { width:100%; height:100%; } body { display:block; margin:0; overflow:hidden; }"},Ne.popups={},Ne.callbacks={},Ne.iframes={},Ne.new=function(t){var e;return null==t&&(t={}),e=t.name||Ae(),t.name=e,this.popups[e]=new Ne(t),this.popups[e].init()},Ne.receiver=function(t,e){var i;return i=t.d.event,"function"==typeof Ne[i="on"+Re(i)]?Ne[i](t,e):void 0},Ne.onCreate=function(t,e){var i,n,r,o;return n=t.d.name,(i=document.createElement("iframe")).setAttribute("class","wdgtc-popup"),i.setAttribute("name",n),i.isOverlay="overlay"===t.d.type,i.setAttribute("style","border: 0; width: 0; height: 0; position: absolute; top: 0; left: -10000px; z-index: 2147483646;"),i.isOverlay&&(i.style.zIndex=2147483647),i.isVisible=!1,i._parent=e.source,i._parentFrame=document.getElementsByName(t.d.source)[0],document.querySelectorAll("body")[0].appendChild(i),i.setAttribute("src",be.popup+"&name="+encodeURIComponent(n)+"&event=ready"),(this.iframes[n]=i).doPosition=(r=this,function(){var t;return r.doPosition(i,null),t={t:"p",d:{event:"reposition",name:n,response:{info:ye(i)}}},Ie(t,i._parent)}),i.doPosition=ke(i.doPosition),xe.on(window,"resize",i.doPosition),xe.on(window,"scroll",i.doPosition),this.callbacks[n]=(o=this,function(){return delete o.callbacks[n],ze(t,e)})},Ne.onReady=function(t){var e,i;return"function"==typeof(e=this.callbacks)[i=t.d.name]?e[i]():void 0},Ne.onDone=function(t,e){var i;return i=t.d.original,this[i="on"+Re(i)+"Done"]?this[i](t,e):ve(t,t.d.response)},Ne.onCreateDone=function(t,e){var i,n;if(!(i=(n=e.source).frames[t.d.name]))for(;n!==e.source.top;){n=n.parent;try{if(i=n.frames[t.d.name])break}catch(t){}}return ve(t,i)},Ne.onReposition=function(t,e){return this.popups[t.d.name].info=t.d.response.info,this.popups[t.d.name].trigger("reposition")},Ne.onManage=function(t,e){var i,n,r,o;return r=t.d.name,i=this.iframes[r],(o=("function"==typeof this[n="do"+Re(t.d.do)]?this[n](i,t.d):void 0)||{}).info=ye(i),ze(t,e,o)},Ne.doResize=function(t,e){return t.isOverlay||(t.style.width=e.dimensions.width+"px",t.style.height=e.dimensions.height+"px",e.dimensions.shadow&&(t.style.boxShadow=e.dimensions.shadow),e.dimensions.borderRadius&&(t.style.borderRadius=e.dimensions.borderRadius)),e.dimensions},Ne.doHide=function(t,e){t.isVisible=!1,t.style.display="none"},Ne.doShow=function(t,e){t.isVisible=!0,t.style.display="block",t.style.position=t.isOverlay?"fixed":"absolute"},Ne.doPosition=function(t,e){var i,n,r,o,s,a,u;if(t.isVisible||(t.style.display="none"),t.isOverlay)return t.style.position="fixed",t.style.width="100%",t.style.height="100%",t.style.top=0,t.style.left=0,t.style.bottom=0,void(t.style.right=0);if(e)t.positionOptions=e;else{if(!t.positionOptions)return;e=t.positionOptions}o=e.offset,s=e.dimensions,i=Ee({},e.anchor),(n=document.querySelector('iframe[name="'+i.parent+'"]'))&&(u=(a=Ce(n)).top,r=a.left,i.top+=u,i.left+=r),r=window.innerWidth+window.scrollX-(i.left+s.width+o.rightMargin+o.leftOffset),r=Math.max(0,i.left+o.leftOffset+Math.min(0,r)),(u=0<=(u=window.innerHeight+window.scrollY-(i.top+i.height+s.height+o.bottomMargin))?i.top+i.height+o.topOffset:i.top-s.height-o.bottomMargin)<0&&(u=i.top+i.height+o.topOffset),t.style.top=u+"px",t.style.left=r+"px"},Ne.doRelease=function(t,e){var i;t.parentNode.removeChild(t),xe.off(window,"resize",t.doPosition),xe.off(window,"scroll",t.doPosition),i=e.name,delete this.iframes[i]},Ne.hideAll=function(){var i,n;return function(){var t,e;for(i in e=[],t=Ne.iframes)n=t[i],e.push(n);return e}().filter(function(t){return t.isVisible}).map(function(t){return Ne.doHide(t),Ie({t:"p",d:{event:"hide",name:t.name}},t._parent)})},Ne.onHide=function(t,e){return this.popups[t.d.name]._hide()},Ne.prototype.type="popup",Ne.prototype.topOffset=0,Ne.prototype.leftOffset=0,Ne.prototype.rightMargin=15,Ne.prototype.bottomMargin=15,Ne.prototype.copyStyles=!0,Ne.prototype.on=function(t,e){return this._callbacks[t]=this._callbacks[t]||[],this._callbacks[t].push(e)},Ne.prototype.off=function(t){return t?this._callbacks[t]=[]:this._callbacks={}},Ne.prototype.trigger=function(t,e){var i,n,r,o,s;if(this._callbacks[t]){for(s=[],n=0,r=(o=this._callbacks[t]).length;n<r;n++)i=o[n],s.push(i(e));return s}},Ne.prototype.init=function(){return this._sendEvent("create",{type:this.type,source:window.name}).then(this._prepare)},Ne.prototype.append=function(t){return t.jquery&&(t=t[0]),this.content.innerHTML="",this.content.appendChild(t),this.resize()},Ne.prototype.style=function(e,t){var i;null==t&&(t=!1),this.styleElement||(this.styleElement=document.createElement("style"),this.head.appendChild(this.styleElement)),null==this.preservedStyles&&(this.preservedStyles="");try{this.styleElement.innerHTML=this.preservedStyles+e}catch(t){this.styleElement.styleSheet.cssText=this.preservedStyles+e}return t&&(this.preservedStyles+=e),(i=_e.defer()).resolve(this.preservedStyles+e),i.promise},Ne.prototype.resize=function(){return this.dimensions={width:this.document.body.offsetWidth,height:this.document.body.offsetHeight},this._sendEvent("manage",{do:"resize",dimensions:this.dimensions}).then(this._saveInfo)},Ne.prototype.hide=function(){return this._sendEvent("manage",{do:"hide"}).then(this._saveInfo).then(this._hide)},Ne.prototype._hide=function(){return this.visible=!1},Ne.prototype.show=function(){return this.position().then((e=this,function(){return e._sendEvent("manage",{do:"show"})})).then(this._saveInfo).then((t=this,function(){return t.visible=!0}));var t,e},Ne.prototype.position=function(){var t,e;return e={topOffset:this.topOffset,leftOffset:this.leftOffset,bottomMargin:this.bottomMargin,rightMargin:this.rightMargin},(t=Ce(this.anchor)).parent=window.name,t.width=parseInt(this.anchor.offsetWidth,10),t.height=parseInt(this.anchor.offsetHeight,10),this._sendEvent("manage",{do:"position",anchor:t,dimensions:this.dimensions,offset:e}).then(this._saveInfo)},Ne.prototype.release=function(){var t,e,i;return e=(t=_e.defer()).promise,this.document.location.reload(),setTimeout(t.resolve,1e3),e.then((i=this,function(){return i._sendEvent("manage",{do:"release"})}))},Ne.prototype._saveInfo=function(t){return this.info=t.info,t},Ne.prototype._sendEvent=function(t,e){var i,n,r,o;return i={name:this.name,event:t},i=Ee(i,e),r=(o=qe(i)).promise,n=o.message,Ie(n,this.targetWindow),r},Ne.prototype._prepare=function(t){var e,i,n;return this.window=t,this.document=this.window.document,this.head=this.document.head,this.loader=document.createElement("div"),this.loader.id="loader",this.loader.style.display="none",this.loader.innerHTML='<div class="sk-three-bounce"> <div class="sk-child sk-bounce1"></div> <div class="sk-child sk-bounce2"></div> <div class="sk-child sk-bounce3"></div> </div>',this.document.body.appendChild(this.loader),this.content=document.createElement("div"),this.document.body.appendChild(this.content),i='<style type="text/css">'+Ne.styles[this.type]+"</style>",this.head.insertAdjacentHTML("beforeend",i),i=document.querySelectorAll("[data-widget-style=true]"),i=(i=Array.prototype.map.call(i,Te)).reduce(function(t,e){return t+e},""),this.style(i,!0),e=document.querySelectorAll('link[rel="stylesheet"]'),e=Array.prototype.map.call(e,function(t){return t.href}),(this.css||e.length)&&(this.loader.style.display="block",this.content.style.display="none",Me.call(this,this.head,this.css,e,(n=this,function(){return n.loader.style.display="none",n.content.style.display="block",n.resize().then(function(){return n.position()}).then(function(){return n})}))),this},ge=Ne,xe.on(window.document,"click",ge.hideAll);var Pe=ge;var He=function(t){return 0===(t=1<arguments.length?Array.from(arguments).map(function(t){return t.trim()}).filter(function(t){return t.length}).join("-"):t.trim()).length?"":1===t.length?t.toLowerCase():/^[a-z0-9]+$/.test(t)?t:(t!==t.toLowerCase()&&(t=function(t){for(var e=!1,i=!1,n=!1,r=0;r<t.length;r++){var o=t[r];e&&/[a-zA-Z]/.test(o)&&o.toUpperCase()===o?(t=t.substr(0,r)+"-"+t.substr(r),n=i,i=!(e=!1),r++):i&&n&&/[a-zA-Z]/.test(o)&&o.toLowerCase()===o?(t=t.substr(0,r-1)+"-"+t.substr(r-1),n=i,e=!(i=!1)):(e=o.toLowerCase()===o,n=i,i=o.toUpperCase()===o)}return t}(t)),t.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(t,e){return e.toUpperCase()}))};function Le(){}function Ue(t){for(var e,i,n=arguments,r=1,o=arguments.length;r<o;r++)for(e in i=n[r])t[e]=i[e];return t}function De(t){return document.createElement(t)}function We(){return Object.create(null)}function Je(t){this.destroy=Le,this.fire("destroy"),!(this.set=this.get=Le)!==t&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function Be(t,e,i,n,r){for(var o in e)if(i[o]){var s=n[o],a=r[o],u=e[o];if(u)for(var c=0;c<u.length;c+=1){var l=u[c];l.__calling||(l.__calling=!0,l.call(t,s,a),l.__calling=!1)}}}function Qe(t){for(;t&&t.length;)t.shift()()}var Ke={destroy:Je,get:function(t){return t?this._state[t]:this._state},fire:function(t,e){var i=t in this._handlers&&this._handlers[t].slice();if(i)for(var n=0;n<i.length;n+=1)i[n].call(this,e)},observe:function(e,i,t){var n=t&&t.defer?this._observers.post:this._observers.pre;return(n[e]||(n[e]=[])).push(i),t&&!1===t.init||(i.__calling=!0,i.call(this,this._state[e]),i.__calling=!1),{cancel:function(){var t=n[e].indexOf(i);~t&&n[e].splice(t,1)}}},on:function(t,e){if("teardown"===t)return this.on("destroy",e);var i=this._handlers[t]||(this._handlers[t]=[]);return i.push(e),{cancel:function(){var t=i.indexOf(e);~t&&i.splice(t,1)}}},set:function(t){this._set(Ue({},t)),this.root._lock||(this.root._lock=!0,Qe(this.root._beforecreate),Qe(this.root._oncreate),Qe(this.root._aftercreate),this.root._lock=!1)},teardown:Je,_recompute:Le,_set:function(t){var e=this._state,i={},n=!1;for(var r in t)this._differs(t[r],e[r])&&(i[r]=n=!0);n&&(this._state=Ue({},e,t),this._recompute(i,this._state),this._bind&&this._bind(i,this._state),this._fragment&&(Be(this,this._observers.pre,i,this._state,e),this._fragment.p(i,this._state),Be(this,this._observers.post,i,this._state,e)))},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_unmount:function(){this._fragment&&this._fragment.u()},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}},Ve={};function Ge(t,e){Ve[t]=e}function $e(t){delete Ve[t]}var Xe=Object.freeze({add:Ge,remove:$e,find:function(t){if(null==t)return Ve;if(!Ve[t])throw new Error("Embed "+t+" does not exist.");return Ve[t]}}),Ye={left:"",center:"margin: 0 auto",right:"margin: 0 0 0 auto"},Fe={fixed:function(t,e,i){return{wrapStyle:Ye[i]+";max-width: "+t.value+t.unit+"; min-width: "+t.value+t.unit+";",holdStyle:"height: "+e.value+e.unit+"; padding-top: 0;"}},"allow-scale-down":function(t,e,i){var n=100*e.value/t.value;return{wrapStyle:Ye[i]+";max-width: "+t.value+t.unit+";",holdStyle:"padding-top: "+n+"%;"}},"fixed-height":function(t,e,i){return{wrapStyle:Ye[i]+";",holdStyle:"height: "+e.value+e.unit+"; padding-top: 0;"}},"fill-width":function(t,e,i){var n=100*e.value/t.value;return{wrapStyle:Ye[i]+";",holdStyle:"padding-top: "+n+"%;"}},fill:function(t,e,i){return{wrapStyle:"height: 100%",holdStyle:"height: 100%;min-height:"+e.value+e.unit}}},Ze=function(t,e){var i=e.map(function(t){return t.id});return t.filter(function(t){return!i.includes(t.id)})},ti=function(t,e){var i=e.map(function(t){return t.id});return t.filter(function(t){return i.includes(t.id)})};function ei(){this.composition&&this.composition.close(),$e(this.get("self"))}function ii(t){!function(t,e){t._observers={pre:We(),post:We()},t._handlers=We(),t._bind=e._bind,t.options=e,t.root=e.root||t,t.store=t.root.store||e.store}(this,t),this.refs={},this._state=Ue({resize:"fill-width",theme:{},content:[],width:500,height:300},t.data),this._recompute({width:1,height:1,widthUnit:1,heightUnit:1,autoscale:1,resize:1,inline:1,widthConfig:1,heightConfig:1,align:1,inlineStyle:1,styles:1,id:1,widget:1,ref:1,theme:1,actualAutoscale:1,content:1,adaptive:1},this._state),this._handlers.destroy=[ei];var e=function(){var o=this;Ge(this.get("self"),this),this.observe("config",this._createEmbed),this.observe("actualAutoscale",function(){return o.refs.wrap.style.height="auto"}),this.observe("wrapStyle",function(){return o.set({wrapHeight:o.refs.wrap.style.height})}),this.observe("theme",function(t){return o.composition.changeSkin(t)}),this.observe("content",function(t,e){if(e){var i=Ze(t,e),n=Ze(e,t),r=ti(t,e);i.map(function(t){return o.composition.addContent(t)}),n.map(function(t){return o.composition.removeContent(t)}),r.map(function(t){return o.composition.changeContent(t)})}})}.bind(this);t.root||(this._oncreate=[]),this._fragment=function(i,t){var n,r,o;return{c:function(){n=De("div"),r=De("div"),this.h()},h:function(){r.className="wdgtc-holder",r.style.cssText=t.holdStyle,n.className="wdgtc-wrap",n.style.cssText=o=t.wrapStyle+"height:"+t.wrapHeight},m:function(t,e){!function(t,e,i){e.insertBefore(t,i)}(n,t,e),function(t,e){e.appendChild(t)}(r,n),i.refs.holder=r,i.refs.wrap=n},p:function(t,e){t.holdStyle&&(r.style.cssText=e.holdStyle),(t.wrapStyle||t.wrapHeight)&&o!==(o=e.wrapStyle+"height:"+e.wrapHeight)&&(n.style.cssText=o)},u:function(){!function(t){t.parentNode.removeChild(t)}(n)},d:function(){i.refs.holder===r&&(i.refs.holder=null),i.refs.wrap===n&&(i.refs.wrap=null)}}}(this,this._state),this.root._oncreate.push(e),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),Qe(this._oncreate))}Ue(ii.prototype,{_createEmbed:function(t){var e=this;this.composition&&this.composition.close(),this.set({wrapHeight:"auto"}),this.composition=Widgetic.UI.composition(this.refs.holder,t),this.composition.on("reload",function(t){e.composition.changeSkin(e.get("theme")),e.get("content").map(function(t){return e.composition.addContent(t)})}),this.api=this.composition.api,this.subscribe=this.composition.on.bind(this.composition),this.composition._iframe.setAttribute("style","position:absolute;top:0;left:0;width:0;height:0;max-width:100%;min-height:100%;min-width:100%")}},Ke),ii.prototype._recompute=function(t,e){t.width&&this._differs(e.widthUnit,e.widthUnit=function(t){return String(t).replace(parseInt(t),"")||"px"}(e.width))&&(t.widthUnit=!0),t.height&&this._differs(e.heightUnit,e.heightUnit=function(t){return String(t).replace(parseInt(t),"")||"px"}(e.height))&&(t.heightUnit=!0),(t.width||t.widthUnit)&&this._differs(e.widthConfig,e.widthConfig=function(t,e){return{value:parseInt(t),unit:e}}(e.width,e.widthUnit))&&(t.widthConfig=!0),(t.height||t.heightUnit)&&this._differs(e.heightConfig,e.heightConfig=function(t,e){return{value:parseInt(t),unit:e}}(e.height,e.heightUnit))&&(t.heightConfig=!0),(t.autoscale||t.resize)&&this._differs(e.actualAutoscale,e.actualAutoscale=function(t,e){return"allow-scale-down"===e?t:"fill-width"===e}(e.autoscale,e.resize))&&(t.actualAutoscale=!0),t.inline&&this._differs(e.inlineStyle,e.inlineStyle=function(t){return t?"display:inline-block;vertical-align:middle;":""}(e.inline))&&(t.inlineStyle=!0),(t.resize||t.widthConfig||t.heightConfig||t.align)&&this._differs(e.styles,e.styles=function(t,e,i,n){return Fe[t](e,i,n)}(e.resize,e.widthConfig,e.heightConfig,e.align))&&(t.styles=!0),(t.inlineStyle||t.styles)&&this._differs(e.wrapStyle,e.wrapStyle=function(t,e){return"position:relative;width:100%;overflow:hidden;"+t+e.wrapStyle}(e.inlineStyle,e.styles))&&(t.wrapStyle=!0),t.styles&&this._differs(e.holdStyle,e.holdStyle=function(t){return"position:relative; paddiinng: 0;"+t.holdStyle}(e.styles))&&(t.holdStyle=!0),(t.id||t.widget||t.ref||t.theme||t.actualAutoscale||t.content||t.adaptive)&&this._differs(e.config,e.config=function(t,e,i,n,r,o,s){var a={skin:n,autoscale:r,content:0<o.length?o:null,demo:0===o.length,adaptive:s};return i&&(a.ref=i),t?a.composition=t:a.widget_id=e,a}(e.id,e.widget,e.ref,e.theme,e.actualAutoscale,e.content,e.adaptive))&&(t.config=!0),(t.id||t.ref)&&this._differs(e.self,e.self=function(t,e){return e||t||N()}(e.id,e.ref))&&(t.self=!0)};var ni=Object.freeze({default:ii}),ri=["id","ref","widget","theme","inline","autoscale","resize","width","height","adaptive","align"];function oi(t){return Array.prototype.slice.call(t).reduce(function(t,e){return t[e.name]=e.value,t},{})}function si(n){var t=ri.map(function(t){var e,i=n.getAttribute(t);if(null!==i)return(e={})[t]=i,e}).filter(function(t){return void 0!==t}).reduce(function(t,e){return Object.assign(t,e)});return{target:n,data:Object.assign(t,{theme:function(t){var e=oi(t.attributes),i={};for(var n in e)ri.includes(n)||(i[He(n.replace("data-",""))]=e[n]);e.theme&&(i.id=e.theme);return i}(n),content:function(t){return Array.prototype.slice.call(t.children).map(function(t){return{attrs:oi(t.attributes),content:t.innerHTML}}).map(function(t,e){var i=t.attrs,n=t.content,r={id:e+1,order:e+1,metadata:{service:"declarative"}};for(var o in i)r.metadata[He(o.replace("data-",""))]=i[o];return n&&(r.metadata.content=n.trim()),r})}(n)})}}function ai(t){t.target.__wdgtcparsed=!0,t.target.innerHTML="",new ii(t)}function ui(t){return void 0===t&&(t=document),function(t){return Array.prototype.slice.call(t.querySelectorAll("*")).filter(function(t){return 0===t.tagName.indexOf("WIDGETIC-")}).filter(function(t){return 1!=t.__wdgtcparsed})}(t).map(si)}var ci,li,hi,di,pi,fi,mi,gi,yi,vi,_i,wi,bi,ki=Object.freeze({extractDeclarativeEmbeds:ui,parseDeclarativeEmbeds:function(){ui().map(ai)}});pi=ki.parseDeclarativeEmbeds,_i=Rt,mi=B,ci="allow-scale-down",gi=function(t){var e,i,n;return e=t.children[0],n=t.parentNode,t.removeChild(e),(i=document.createDocumentFragment()).insertBefore(e,null),n.insertBefore(i,t),n.removeChild(t),e},hi=function(t){return t.children[0]},yi=function(t,e,i,n){var r;return r=e?"display:inline-block;vertical-align:middle;":"",n?'<div style="width:100%;'+r+(i.wrapStyle||"")+'"><div style="position:relative; padding: 0;'+(i.holdStyle||"")+'">$$$</div></div>':'<div class="wdgtc-wrap" data-wdgtc-id="'+t+'" style="width:100%;'+r+(i.wrapStyle||"")+'"> <div class="wdgtc-holder" style="position:relative; padding: 0;'+(i.holdStyle||"")+'"> </div> </div>'},vi={fixed:function(t,e){return{wrapStyle:"max-width: "+t+"px; min-width: "+t+"px;",holdStyle:"padding-top: "+100*e/t+"%;"}},"allow-scale-down":function(t,e){return{wrapStyle:"max-width: "+t+"px;",holdStyle:"padding-top: "+100*e/t+"%;"}},"fixed-height":function(t,e){return{holdStyle:"height: "+e+"px; padding-top: 0;"}},"fill-width":function(t,e){return{holdStyle:"padding-top: "+100*e/t+"%;"}},fill:function(t,e){return{wrapStyle:"height: 100%",holdStyle:"height: 100%;min-height:"+e+"px"}}},fi=function(){var n,r,o,t,e,s,a,u,i,c,l,h,d,p;for(h=/\[widgetic\-([-\w]+) *((?: [-\w]+(?:=.*?)?)+)\]/gi,o=/\s+/g,d=function(t,e,i){return'<a href="https://widgetic.com/widget/'+e+'/" class="widgetic-composition" '+i.trim().replace(o," ").split(" ").map(function(t){return"data-"+t}).join(" ")+"></a>"},l=[],t=0,e=(i=document.querySelectorAll("body, body *")).length;t<e;t++)"HEAD"!==(c=(u=i[t]).nodeName)&&"META"!==c&&"LINK"!==c&&"SCRIPT"!==c&&"TITLE"!==c&&(n=u.childNodes,l.push(function(){var t,e,i;for(i=[],t=0,e=n.length;t<e;t++)3===(r=n[t]).nodeType&&(p=r.nodeValue,a=p.replace(h,d),p!==a?((s=document.createElement("div")).innerHTML=a,i.push(u.replaceChild(s,r))):i.push(void 0));return i}()));return l},(di=function(){return _i(function(){var t,e,i,n;for(pi(),fi(),i=0,n=(t=document.querySelectorAll(".widgetic-composition")).length;i<n;i++)e=t[i],li(e);mi.publish("parse")})}).wrapperHtml=function(t,e){var i;return null==e&&(e=!1),i=vi[t.resize](t.width,t.height),yi(t.composition,t.inline,i,e)},di.iframeStyle="position:absolute;top:0;left:0;width:0;height:0;max-width:100%;min-height:100%;min-width:100%",li=function(t){var e,i,n;if((n={composition:t.getAttribute("data-id"),width:t.getAttribute("data-width")||300,height:t.getAttribute("data-height")||200,resize:t.getAttribute("data-resize")||ci,brand_pos:t.getAttribute("data-brand")||"bottom-right",branding:t.hasAttribute("data-branding"),inline:t.hasAttribute("data-inline"),autoscale:t.getAttribute("data-autoscale")||"on"}).composition)return vi[n.resize]||(n.resize=ci),t.insertAdjacentHTML("afterbegin",di.wrapperHtml(n)),t=gi(t),i=hi(t),(e=new Widgetic.UI.composition(i,n.composition,n))._iframe.setAttribute("style",di.iframeStyle),e._iframe.style.visibility="hidden",e._iframe.onload=function(){return e._iframe.style.visibility="visible"}};var Si,xi,Ei,Ci,Ti,Ai,Oi,Mi,qi,zi,Ii,Ri,ji,Ni,Pi,Hi,Li,Ui,Di,Wi=Xe;qi=v,Ei=It,Ai=At,Oi=bt,zi=Vt,Ii=b,Ui=Rt,Si=wi=re,xi=bi=de,Ci={Composition:wi,Editor:bi,composition:function(){return function(t,e,i){i.prototype=t.prototype;var n=new i,r=t.apply(n,e);return Object(r)===r?r:n}(wi,arguments,function(){})},editor:function(){return function(t,e,i){i.prototype=t.prototype;var n=new i,r=t.apply(n,e);return Object(r)===r?r:n}(bi,arguments,function(){})},parse:di,popup:Pe,plugin:je,Embed:ni&&ii||ni},Mi=J,Di=window,Ri=!1,Li={a:Ai.request,e:Ai.response,i:Ei.connect,o:Oi.connect,d:Si.apiReady,u:Si.connect,ce:Si.event,pr:Si.publicApiCallReply,w:xi.connect,ee:xi.event,p:Ci.popup.receiver,r:Oi.retry,v:Ci.plugin.connect,ve:Ci.plugin.event,su:Si.updateSize},Ni=(Ni=qi.lo.replace(/(http|https)\:/,"")+"|"+qi.domain.replace(/(http|https)\:/,"")).replace(/\./g,"\\."),Ni=new RegExp(Ni),window.widgeticReceiver=Hi=function(t){var e,i,n;if(Ni.test(t.origin)){e=t.data;try{if("string"!=typeof e)return;e=JSON.parse(e)}catch(t){return i=t,void console.warn("Widgetic SDK: error parsing JSON:",e)}try{return"function"==typeof Li[n=e.t]?Li[n](e,t):void 0}catch(t){return i=t,console.error("Widgetic SDK: ",i.stack)}}},Ti=function(){return"function"==typeof Di.WidgeticAsyncInit&&Di.WidgeticAsyncInit(),Ii.on(Di,"message",Hi),zi(Di.location.href),Ei.style(),setTimeout(Ci.parse)},Pi=Mi.defer(),ji=function(){var t,e;return Ri||(e=this,t=function(){return(e.root=new Ei).createProxy().then(function(){return Pi.resolve()}).fail(function(t){return Pi.reject(t)}),Ri=!0},document.getElementsByTagName("body")[0]?t():Ui(t)),Pi.promise},Ti.prototype.init=function(t,e){return ji.call(this),t&&e&&Oi.setAuthOptions(t,e),this},Ti.prototype.api=function(){var t;return t=arguments,ji.call(this).then(function(){return Ai.apply(this,t)})},(Ti.prototype.auth=function(){return Oi.apply(this,arguments)}).register=function(){return Oi.register.apply(this,arguments)},Ti.prototype.auth.status=function(){return Ai.getStatus.apply(this,arguments)},Ti.prototype.auth.token=function(){return Ai.accessToken.apply(this,arguments)},Ti.prototype.auth.disconnect=function(){return Ai.disconnect.apply(this,arguments)},Ti.prototype.JSON=JSON,Ti.prototype.Queue=Ai.queue,Ti.prototype.Aye=J,Ti.prototype.Event=Ii,Ti.prototype.GUID=Q,Ti.prototype.pubsub=B,Ti.prototype.UI=Ci,Ti.prototype.find=Wi.find,Ti.prototype.EVENTS={COMPOSITION_SAVED:"save",SKIN_SAVED:"skin-save"},Ti.prototype.version="1.6.0",Ti.prototype.parse=zi.parse,Ti.prototype.uxhr=k,Ti.prototype.debug={timestamp:function(){return console.warn("Widgetic.debug.timestamp is deprecated.")}};var Ji=Ti;return t(function(t){var e,i;e=Ji,window.Widgetic?t.exports=window.Widgetic:(i=new e,t.exports=i,window.Blogvio=i)})}();